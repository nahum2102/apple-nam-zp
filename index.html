<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PEAR STORE</title>

<style>
:root{
  --bg:#fdfdfd;
  --card:#ffffff;
  --accent:#000000;
  --accent-hover:#333333;
  --success:#34c759;
  --shadow:0 6px 20px rgba(0,0,0,0.08);
}

*{box-sizing:border-box}
body{margin:0;font-family:'Segoe UI', sans-serif;background:var(--bg);color:#111;line-height:1.5}
a{text-decoration:none}

/* Header */
header{
  background:#000;color:#fff;padding:20px 0;text-align:center;font-weight:700;
  font-size:28px;letter-spacing:1px;text-transform:uppercase;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
  position:relative;
}

#cartCounter{
  position:absolute;
  top:15px;
  right:20px;
  background:#fff;
  color:#000;
  font-weight:bold;
  padding:4px 10px;
  border-radius:50%;
  font-size:14px;
  box-shadow:0 2px 6px rgba(0,0,0,0.3);
}

/* BOT√ìN CARRITO */
#btnCarrito{
  position:absolute;
  right:70px;
  top:12px;
  background:#fff;
  color:#000;
  padding:6px 12px;
  border-radius:8px;
  border:0;
  cursor:pointer;
  font-weight:bold;
}

/* Layout */
.wrap{
  width:95%; max-width:1200px;margin:32px auto;
  transition:0.45s ease;
}

/* Cat√°logo */
.catalogo{
  display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:20px;
}

.producto{
  background:var(--card); border-radius:14px; padding:18px;
  box-shadow:var(--shadow); text-align:center;
  transition:transform 0.3s, box-shadow 0.3s;
  position:relative;
}
.producto:hover{
  transform:translateY(-4px);
  box-shadow:0 10px 25px rgba(0,0,0,0.12);
}

/* Carrusel */
.carousel{
  width:100%; height:180px; position:relative; overflow:hidden;
  border-radius:12px; margin-bottom:12px;
}
.carousel img{
  width:100%; height:100%; object-fit:cover;
}
.btn-slide{
  position:absolute; top:50%; transform:translateY(-50%);
  background:rgba(0,0,0,0.5); color:white; border:none;
  border-radius:50%; width:28px; height:28px;
  cursor:pointer; font-size:18px; line-height:1;
  display:flex; align-items:center; justify-content:center;
}
.prev{left:8px} .next{right:8px}

/* Bot√≥n comprar */
.btn{
  padding:10px 16px; border-radius:8px; border:0; cursor:pointer;
  font-weight:600; transition:0.3s;
}
.btn-comprar{background:var(--accent); color:#fff}
.btn-comprar:hover{background:var(--accent-hover)}

/* Carrito lateral */
.panel-carrito{
  position:fixed;
  top:0;
  right:-360px;
  width:360px;
  height:100%;
  background:white;
  box-shadow:-4px 0 15px rgba(0,0,0,0.25);
  transition:right 0.3s ease;
  z-index:9999;
  display:flex;
  flex-direction:column;
}

.panel-carrito.abierto{
  right:0;
}

/* Contenido scrollable */
.panel-carrito .contenido-carrito{
  flex:1;
  overflow-y:auto;
  padding:20px;
  -webkit-overflow-scrolling: touch;
}

/* Bot√≥n fijo */
.panel-carrito .footer-carrito{
  padding:12px 20px;
  border-top:1px solid #eee;
  background:white;
}

/* Cerrar bot√≥n */
.cerrar-btn{
  background:#ff3b30;
  color:white;
  border:0;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.carrito-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}

/* Fondo oscuro */
.fondo-oscuro{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.45);
  z-index:9000;
  opacity:1;
  transition:0.4s ease;
}
.fondo-oscuro.oculto{
  opacity:0;
  pointer-events:none;
}

/* Blur del contenido */
.contenido-desplazado{
  transform:translateX(-220px);
  filter:blur(3px);
}

/* Toast */
.toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #111;
  color: white;
  padding: 12px 18px;
  border-radius: 10px;
  opacity: 0;
  transform: translateY(20px);
  transition: 0.4s ease;
  z-index: 99999;
  font-weight: bold;
}
.toast.mostrar {
  opacity: 1;
  transform: translateY(0);
}

/* Pago */
.metodoPago{
  border:1px solid #ccc; border-radius:10px; padding:14px;
  margin-bottom:12px; cursor:pointer; transition:0.3s;
  background:#f9f9f9; font-size:15px;
}
.metodoPago.selected{
  border-color:var(--accent);
  background:#eaeaea;
}

.btn-finalizar{
  background:var(--success); color:#fff; width:100%;
  border:0; border-radius:10px; padding:12px;
  margin-top:0;
  cursor:pointer; font-weight:bold; font-size:16px;
}
.btn-finalizar:hover{background:#28a745}

input{
  width:100%; padding:8px; margin:6px 0;
  border-radius:8px; border:1px solid #ccc; font-size:14px;
}

.btn-eliminar{
  background:#ff3b30; color:#fff; border:0; border-radius:6px;
  padding:6px 10px; cursor:pointer;
}

.linea-item{
  display:flex; justify-content:space-between; padding:8px 0;
  border-bottom:1px solid #eee; font-size:14px;
}
</style>
</head>

<body>

<header>
  PEAR STORE 
  <span id="cartCounter">0</span>

  <!-- Bot√≥n Carrito -->
  <button id="btnCarrito" onclick="abrirCarrito()">Carrito</button>
</header>

<!-- Fondo oscuro -->
<div id="fondoOscuro" class="fondo-oscuro oculto"></div>

<!-- Toast -->
<div id="toast" class="toast">Producto agregado ‚úîÔ∏è</div>

<div class="wrap">
  <section id="catalogo" class="catalogo"></section>
</div>

<!-- PANEL LATERAL DEL CARRITO -->
<div id="panelCarrito" class="panel-carrito">
  <div class="contenido-carrito">
    <div class="carrito-header">
      <h3>Carrito</h3>
      <button class="cerrar-btn" onclick="cerrarCarrito()">X</button>
    </div>

    <div id="carritoItems"><p>El carrito est√° vac√≠o.</p></div>
    <div id="total" style="font-weight:bold;margin-top:12px">Total: $0</div>

    <h4>M√©todo de entrega</h4>
    <div id="domicilioCaja" class="metodoPago selected" onclick="seleccionarEntrega('domicilio')"><b>Entrega a domicilio</b></div>
    <div id="personalCaja" class="metodoPago" onclick="seleccionarEntrega('personal')"><b>Entrega personal</b></div>

    <div id="direccionCampos">
      <h4>Datos del domicilio</h4>
      <input type="text" id="nombre" placeholder="Nombre completo">
      <input type="text" id="calle" placeholder="Calle y n√∫mero">
      <input type="text" id="colonia" placeholder="Colonia">
      <input type="text" id="ciudad" placeholder="Ciudad">
    </div>

    <h4>M√©todo de pago</h4>
    <div id="transferenciaCaja" class="metodoPago" onclick="seleccionarPago('transferencia')">
      <b>Transferencia Bancaria</b>
      <div id="transferenciaInfo" style="display:none;">
        <p>Banco: <b>Spin by OXXO</b></p>
        <p>Cuenta/CLABE: <b>728969000160872559</b></p>
        <p>Titular: <b>Nahum Aquino</b></p>
        <p>Enviar comprobante: <b>8145344751</b></p>
      </div>
    </div>

    <div id="efectivoCaja" class="metodoPago selected" onclick="seleccionarPago('efectivo')"><b>Efectivo</b></div>
  </div>

  <!-- Bot√≥n siempre visible -->
  <div class="footer-carrito">
    <button class="btn-finalizar" onclick="abrirWhatsApp()">Enviar Pedido</button>
  </div>
</div>

<script>
/* ----------------------------
   PRODUCTOS
---------------------------- */
const productos = [
  {id:1,nombre:"AirPods 2 Pro",precio:450,imagenes:["IMG-1235.webp","IMG-1232.webp","IMG-1235.webp"]},
  {id:2,nombre:"AirPods 3ra Generaci√≥n",precio:450,imagenes:["E14433AB-04B2-4D85-8821-764E59DE4FE6.webp","DF7EDE8C-9CE1-4436-B993-4094D12430DF.webp","D3617BDC-8397-48C0-B488-CAAC985058B9.webp"]},
  {id:3,nombre:"Cargador USB-C 35W",precio:250,imagenes:["82B70C5A-37C7-4337-8C92-CD52E626A8C1.webp","926667B9-EC57-43F3-A745-544619645143.webp"]},
  {id:4,nombre:"Cable Lightning Original",precio:250,imagenes:["4FF89AC7-8830-4A38-B846-F11A91BE8560.webp"]},
  {id:5,nombre:"Bater√≠a MagSafe",precio:300,imagenes:["3E6EF8DC-C60E-4895-8492-9791AB026C79.webp"]},
];

let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
let metodoPagoSeleccionado = "efectivo";
let metodoEntrega = "domicilio";

/* ----------------------------
   CATALOGO
---------------------------- */
function renderizarCatalogo(){
  const cont = document.getElementById("catalogo");
  cont.innerHTML = "";

  productos.forEach(p=>{
    const div=document.createElement("div");
    div.className="producto";
    div.innerHTML=`
      <div class="carousel" data-id="${p.id}">
        <img src="${p.imagenes[0]}" data-index="0">
        <button class="btn-slide prev">‚Äπ</button>
        <button class="btn-slide next">‚Ä∫</button>
      </div>

      <h4>${p.nombre}</h4>
      <div class="precio">$${p.precio}</div>
      <button class="btn btn-comprar" onclick="agregarCarrito(${p.id})">Comprar</button>
    `;

    cont.appendChild(div);
  });

  activarCarruseles();
}

function activarCarruseles(){
  document.querySelectorAll(".carousel").forEach(c=>{
    const id=c.dataset.id;
    const p=productos.find(x=>x.id==id);
    const img=c.querySelector("img");
    let index=0;

    c.querySelector(".next").onclick=()=>{
      index=(index+1)%p.imagenes.length;
      img.src=p.imagenes[index];
    };

    c.querySelector(".prev").onclick=()=>{
      index=(index-1+p.imagenes.length)%p.imagenes.length;
      img.src=p.imagenes[index];
    };
  });
}

/* ----------------------------
   CARRITO
---------------------------- */
function actualizarCarrito(){
  localStorage.setItem("carrito", JSON.stringify(carrito));

  const cont=document.getElementById("carritoItems");
  cont.innerHTML="";

  if(carrito.length===0){
    cont.innerHTML="<p>El carrito est√° vac√≠o.</p>";
    document.getElementById("total").innerText="Total: $0";
    document.getElementById("cartCounter").innerText = 0;
    return;
  }

  let total=0;
  let totalCantidad=0;

  carrito.forEach(i=>{
    const sub=i.precio*i.cantidad;
    total+=sub;
    totalCantidad+=i.cantidad;

    cont.innerHTML+=`
      <div class="linea-item">
        <div>
          <b>${i.nombre}</b><br>
          $${i.precio} c/u
          <br>
          <div style="margin-top:6px;">
            <button onclick="cambiarCantidad(${i.id}, -1)" style="padding:4px 10px;">‚àí</button>
            <span style="margin:0 8px; font-weight:bold;">${i.cantidad}</span>
            <button onclick="cambiarCantidad(${i.id}, 1)" style="padding:4px 10px;">+</button>
          </div>
        </div>

        <div style="text-align:right;">
          <div>$${sub}</div>
          <button class="btn-eliminar" onclick="cambiarCantidad(${i.id}, -${i.cantidad})">X</button>
        </div>
      </div>
    `;
  });

  document.getElementById("total").innerText = "Total: $" + total;
  document.getElementById("cartCounter").innerText = totalCantidad;
}

function cambiarCantidad(id, cambio){
  let item = carrito.find(x=>x.id===id);
  if(!item) return;

  item.cantidad += cambio;
  if(item.cantidad <=0){
    carrito = carrito.filter(x=>x.id!==id);
  }

  actualizarCarrito();
}

/* ----------------------------
   TOAST
---------------------------- */
function mostrarToast(){
  const t = document.getElementById("toast");
  t.classList.add("mostrar");
  setTimeout(()=> t.classList.remove("mostrar"), 2000);
}

/* ----------------------------
   ABRIR / CERRAR CARRITO
---------------------------- */
function abrirCarrito(){
  document.getElementById("panelCarrito").classList.add("abierto");
  document.getElementById("fondoOscuro").classList.remove("oculto");
  document.querySelector(".wrap").classList.add("contenido-desplazado");
}

function cerrarCarrito(){
  document.getElementById("panelCarrito").classList.remove("abierto");
  document.getElementById("fondoOscuro").classList.add("oculto");
  document.querySelector(".wrap").classList.remove("contenido-desplazado");
}

/* Cerrar al hacer clic fuera */
document.getElementById("fondoOscuro").addEventListener("click", cerrarCarrito);

/* ----------------------------
   DRAG PARA CERRAR
---------------------------- */
let startX = 0;

document.getElementById("panelCarrito").addEventListener("touchstart", e=>{
  startX = e.touches[0].clientX;
});

document.getElementById("panelCarrito").addEventListener("touchmove", e=>{
  let diff = startX - e.touches[0].clientX;
  if(diff < -60) cerrarCarrito();
});

/* ----------------------------
   AGREGAR AL CARRITO
---------------------------- */
function agregarCarrito(id){
  const p = productos.find(x=>x.id===id);
  let item = carrito.find(x=>x.id===id);

  if(item) item.cantidad++;
  else carrito.push({id:p.id,nombre:p.nombre,precio:p.precio,cantidad:1});

  actualizarCarrito();
  mostrarToast();
}

/* ----------------------------
   ENTREGA Y PAGO
---------------------------- */
function seleccionarEntrega(tipo){
  metodoEntrega = tipo;

  document.getElementById("domicilioCaja").classList.remove("selected");
  document.getElementById("personalCaja").classList.remove("selected");

  if(tipo==="domicilio"){
    document.getElementById("domicilioCaja").classList.add("selected");
    document.getElementById("direccionCampos").style.display="block";
  } else {
    document.getElementById("personalCaja").classList.add("selected");
    document.getElementById("direccionCampos").style.display="none";
  }
}

function seleccionarPago(metodo){
  metodoPagoSeleccionado = metodo;

  document.getElementById("transferenciaCaja").classList.remove("selected");
  document.getElementById("efectivoCaja").classList.remove("selected");

  if(metodo==="transferencia"){
    document.getElementById("transferenciaCaja").classList.add("selected");
    document.getElementById("transferenciaInfo").style.display="block";
  } else {
    document.getElementById("efectivoCaja").classList.add("selected");
    document.getElementById("transferenciaInfo").style.display="none";
  }
}

/* ----------------------------
   ENVIAR PEDIDO POR WHATSAPP
---------------------------- */
function abrirWhatsApp(){
  if(carrito.length===0){
    alert("El carrito est√° vac√≠o.");
    return;
  }

  let mensaje = "üì¶ *Pedido PEAR STORE*%0A";
  mensaje += "M√©todo de entrega: " + (metodoEntrega==="domicilio" ? "Domicilio" : "Entrega personal") + "%0A";
  mensaje += "M√©todo de pago: " + (metodoPagoSeleccionado==="transferencia" ? "Transferencia" : "Efectivo") + "%0A%0A";

  carrito.forEach(i=>{
    mensaje += `${i.nombre} - ${i.cantidad} x $${i.precio} = $${i.cantidad*i.precio}%0A`;
  });

  const total = carrito.reduce((sum, i)=>sum + i.precio*i.cantidad, 0);
  mensaje += `%0ATotal: $${total}%0A`;

  if(metodoEntrega==="domicilio"){
    const nombre=document.getElementById("nombre").value;
    const calle=document.getElementById("calle").value;
    const colonia=document.getElementById("colonia").value;
    const ciudad=document.getElementById("ciudad").value;
    mensaje += `%0ADatos de env√≠o:%0ANombre: ${nombre}%0ACalle: ${calle}%0AColonia: ${colonia}%0ACiudad: ${ciudad}`;
  }

  // N√∫mero de WhatsApp (sin +, formato internacional)
  const numero = "5218145344751"; // M√©xico ejemplo
  const url = `https://wa.me/${numero}?text=${mensaje}`;

  window.open(url,"_blank");
}

/* ----------------------------
   INICIALIZACI√ìN
---------------------------- */
renderizarCatalogo();
actualizarCarrito();
</script>

</body>
</html>
